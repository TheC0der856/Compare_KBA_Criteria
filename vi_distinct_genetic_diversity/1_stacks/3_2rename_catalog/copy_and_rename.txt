#!/bin/bash

# pick paths
src_dir="denovomap2"
dst_dir="denovomap4"
id_file="populations/new_IDs.txt"

# create destination directory if not already present
mkdir -p "$dst_dir"

# read every line of the new_IDs.txt
while read -r old_id new_id; do
    # find all files in source direcoty starting with the old ID
    for file in "$src_dir"/${old_id}*; do
        if [ -e "$file" ]; then
            filename=$(basename "$file")
            # rename files
            new_filename="${filename/$old_id/$new_id}"
            # copy file in new folder
            cp "$file" "$dst_dir/$new_filename"
            echo "Kopiert: $file â†’ $dst_dir/$new_filename"
        fi
    done
done < "$id_file"

# ls denovomap2/T* 2>/dev/null | wc -l
# ls denovomap4/T* 2>/dev/null | wc -l
# the same number of files starting with T
# ls denovomap2/SG* 2>/dev/null | wc -l
# ls denovomap4/SG* 2>/dev/null | wc -l
# same number of SG files



# copy catalog file and so on:

# list of all file name in both directories
ls "$src_dir" | sort > files_src.txt
ls "$dst_dir" | sort > files_dst.txt

# find files only occuring in denovomap2
comm -23 files_src.txt files_dst.txt > files_to_copy.txt

# copy files
while read -r filename; do
    cp "$src_dir/$filename" "$dst_dir/$filename"
    echo "Kopiert: $filename"
done < files_to_copy.txt

# clean up
rm files_src.txt files_dst.txt files_to_copy.txt
